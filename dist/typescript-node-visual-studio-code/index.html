<!doctype html>
<html>
<head>
</head>
<body>
    <p>When developing, there’s three things that I absolutely enjoy:</p>
<ul>
<li>Creating Node.js apps</li>
<li>Working with TypeScript</li>
<li>Debugging said apps in Visual Studio Code</li>
</ul>
<p>I never combined all three of them. I developed Node apps and used the great debugging possibilities with VS Code. Or I wrote my Node.js apps in TypeScript using <code>tsc</code> or <code>ts-node</code>. But together, nope!</p>
<p>That’s where the magic is supposed to be, isn’t it? So I decided to get started with the complete setup. Since it took me a while and it requires some steps, I thought I better share that with you.</p>
<p>I’m using <em>Node 9.8</em>, <em>VS Code 1.21</em> and <em>TypeScript 2.7</em>. Things might be different if you are using other versions.</p>
<p>Let’s go!</p>
<h2>Setting up TypeScript</h2>
<p>I tried to make <code>ts-node</code> work for this setup, and made good progress. But at some point I was stuck and didn’t manage to debug my <em>whole</em> application. So I switched to a mode where I compile TypeScript first, then run debugging on the generated JavaScript files with source maps.</p>
<p>My TypeScript configuration <code>tsconfig.json</code> is pretty standard. I use a pretty late ES target (having Node an all), and I use <code>commonjs</code> as module format to work nicely with Node.js. The folder structure is easy: I have my TypeScript files in <code>src</code>, my output in <code>bin</code>.</p>
<pre><code class="language-javascript">{
  &quot;compilerOptions&quot;: {
    &quot;target&quot;: &quot;es2017&quot;,
    &quot;module&quot;: &quot;commonjs&quot;,
    &quot;allowJs&quot;: true,
    &quot;checkJs&quot;: true,
    &quot;outDir&quot;: &quot;./bin&quot;,
    &quot;sourceMap&quot;: true,
    &quot;strict&quot;: true,
    &quot;noImplicitAny&quot;: true,
    &quot;strictNullChecks&quot;: true
  },
  &quot;include&quot;: [
    &quot;src/**/*.ts&quot;
  ],
  &quot;exclude&quot;: [
    &quot;node_modules&quot;
  ]
}
</code></pre>
<p>There are two important settings that need to be made. First we activate source maps, otherwise VSCode wouldn’t know how to map the generated output to your sources.</p>
<p>Second, I set <code>&quot;esModuleInterop&quot;</code> to <code>true</code>. TypeScript will transform <code>import</code> statements to <code>require</code> statements. We don’t need to work with native <code>import</code> statements on Node anyway.</p>
<p>TypeScript is set up! Once you run <code>tsc</code> in the terminal, you can see the output: generated JavaScript files and source maps along with it.</p>
<h2>VSCode task config</h2>
<p>Now that TypeScript is set up, let’s do the same with VSCode. To make debugging work <em>and</em> pleasant, we want to set up an automated build task that runs <em>before</em> debugging. So every time we hit the debug button, we compile our updated TypeScript sources into JavaScript.</p>
<p>VSCode is pretty clever, as based on your file structure it automatically finds possible commands to run. Hit <code>⌘ + ⇧ + B</code> on Mac or <code>Ctrl + Shift + B</code> on Windows to see possible build tasks.</p>
<p><img src="/wp-content/uploads/vscode-task.jpg" alt="Build tasks"></p>
<p>You can run them by selecting them. If you hit the wheel icon next to it, VSCode creates a <code>tasks.json</code> in the <code>.vscode</code> project folder, with all the setup you need. See below:</p>
<pre><code class="language-javascript">{
  &quot;version&quot;: &quot;2.0.0&quot;,
  &quot;tasks&quot;: [
    {
      &quot;type&quot;: &quot;typescript&quot;,
      &quot;tsconfig&quot;: &quot;tsconfig.json&quot;,
      &quot;problemMatcher&quot;: [
        &quot;$tsc&quot;
      ]
    }
  ]
}
</code></pre>
<p>Alright! Build task is set up! Let’s debug.</p>
<h2>VSCode debug config</h2>
<p>The last thing we have to set up is the debug configuration in the <code>launch.json</code> file. You can generate this JSON file by clicking on the debug tab, and selecting “Add configuration” from the dropdown.</p>
<p><img src="/wp-content/uploads/vscode-debug.jpg" alt="Add configuration in VSCode"></p>
<p>Select “Node.js: Launch Program” and you get a couple of fields pre-filled. The others, the more important ones, we have to set ourselves:</p>
<ul>
<li><code>&quot;preLaunchTask&quot;: &quot;typescript&quot;</code>. This is the task we defined one step earlier. Use the identifier you specified there.</li>
<li><code>&quot;program&quot;: &quot;${workspaceFolder}/src/index.ts&quot;</code>. The program to launch. This is your application’s entry point. In that case the index TypeScript file.</li>
<li><code>&quot;cwd&quot;: &quot;${workspaceFolder}&quot;</code>. Where to execute this program. I usually select the workspace folder.</li>
<li><code>&quot;protocol&quot;: &quot;inspector&quot;</code>. The protocol to communicate between app and debugger. For Node versions greater than 6, use <code>inspector</code>.</li>
<li><code>&quot;outFiles&quot;: [ &quot;${workspaceFolder}/bin/**/*.js&quot;]</code>. An array to the generated output files and source maps. This is what the debugger is actually executing.</li>
</ul>
<p>The whole file looks like this:</p>
<pre><code class="language-javascript">{
  &quot;version&quot;: &quot;0.2.0&quot;,
  &quot;configurations&quot;: [
    {
      &quot;type&quot;: &quot;node&quot;,
      &quot;request&quot;: &quot;launch&quot;,
      &quot;name&quot;: &quot;Debug TypeScript in Node.js&quot;,
      &quot;preLaunchTask&quot;: &quot;typescript&quot;,
      &quot;program&quot;: &quot;${workspaceFolder}/src/index.ts&quot;,
      &quot;cwd&quot;: &quot;${workspaceFolder}&quot;,
      &quot;protocol&quot;: &quot;inspector&quot;,
      &quot;outFiles&quot;: [
        &quot;${workspaceFolder}/bin/**/*.js&quot;
      ]
    }
  ]
}

</code></pre>
<p>And with that, you are all set up. Press the ▶️ button the debug view. You see your compile task executing, and once it’s finished you are right in the debug session.</p>
<p><img src="/wp-content/uploads/vscode.jpg" alt="VSCode in action"></p>
<p>Try setting a breakpoint somewhere and have fun with all the details!</p>
<p>//include helper/include-by-tag.html tag=“TypeScript” title=“More articles about TypeScript”</p>

</body>
</html>
